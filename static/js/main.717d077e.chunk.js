(this["webpackJsonpgoit-react-hw-08-phonebook"]=this["webpackJsonpgoit-react-hw-08-phonebook"]||[]).push([[0],{31:function(t,e,n){"use strict";n.d(e,"b",(function(){return c})),n.d(e,"c",(function(){return I})),n.d(e,"f",(function(){return L})),n.d(e,"h",(function(){return U})),n.d(e,"g",(function(){return _})),n.d(e,"i",(function(){return N})),n.d(e,"e",(function(){return A})),n.d(e,"a",(function(){return E})),n.d(e,"d",(function(){return z}));var c={};n.r(c),n.d(c,"fetchContactsRequest",(function(){return o})),n.d(c,"fetchContactsSuccess",(function(){return s})),n.d(c,"fetchContactsError",(function(){return i})),n.d(c,"addContactRequest",(function(){return l})),n.d(c,"addContactSuccess",(function(){return d})),n.d(c,"addContactError",(function(){return b})),n.d(c,"deleteContactRequest",(function(){return j})),n.d(c,"deleteContactSuccess",(function(){return f})),n.d(c,"deleteContactError",(function(){return O})),n.d(c,"changeFilter",(function(){return h}));var r,a,u=n(3),o=Object(u.b)("contacts/fetchContactsRequest"),s=Object(u.b)("contacts/fetchContactsSuccess"),i=Object(u.b)("contacts/fetchContactsError"),l=Object(u.b)("contacts/addContactRequest"),d=Object(u.b)("contacts/addContactSuccess"),b=Object(u.b)("contacts/addContactError"),j=Object(u.b)("contacts/deleteContactRequest"),f=Object(u.b)("contacts/deleteContactSuccess"),O=Object(u.b)("contacts/deleteContactError"),h=Object(u.b)("contacts/changeFilter"),g=n(4),p=n(25),v=n(8),x=n(9),m=n.n(x);m.a.defaults.baseURL="https://614647788f2f4e001730401d.mockapi.io/api/v1";var k=Object(u.d)([],(r={},Object(g.a)(r,s,(function(t,e){return e.payload})),Object(g.a)(r,d,(function(t,e){return[e.payload].concat(Object(p.a)(t))})),Object(g.a)(r,f,(function(t,e){var n=e.payload;return t.filter((function(t){return t.id!==n}))})),r)),C=Object(u.d)("",Object(g.a)({},h,(function(t,e){return e.payload}))),y=Object(u.d)(!1,(a={},Object(g.a)(a,o,(function(){return!0})),Object(g.a)(a,s,(function(){return!1})),Object(g.a)(a,i,(function(){return!1})),Object(g.a)(a,l,(function(){return!0})),Object(g.a)(a,d,(function(){return!1})),Object(g.a)(a,b,(function(){return!1})),Object(g.a)(a,j,(function(){return!0})),Object(g.a)(a,f,(function(){return!1})),Object(g.a)(a,O,(function(){return!1})),a)),I=Object(v.b)({items:k,filter:C,loading:y}),w=n(24),L=function(t){return t.contacts.items},U=function(t){return t.contacts.loading},_=function(t){return t.contacts.filter},N=Object(w.a)([L,_],(function(t,e){var n=e.toLowerCase().trim();return t.filter((function(t){return t.name.toLowerCase().includes(n)}))})),S=n(15),F=n.n(S),R=n(18);m.a.defaults.baseURL="https://614647788f2f4e001730401d.mockapi.io/api/v1";var A=function(){return function(){var t=Object(R.a)(F.a.mark((function t(e){var n,c;return F.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e(o()),t.prev=1,t.next=4,m.a.get("/contacts");case 4:n=t.sent,c=n.data,e(s(c)),t.next=12;break;case 9:t.prev=9,t.t0=t.catch(1),e(i(t.t0));case 12:case"end":return t.stop()}}),t,null,[[1,9]])})));return function(e){return t.apply(this,arguments)}}()},E=function(t,e){return function(n){var c={name:t,number:e};n(l()),m.a.post("/contacts",c).then((function(t){var e=t.data;return n(d(e))})).catch((function(t){return n(b(t))}))}},z=function(t){return function(e){e(j()),m.a.delete("/contacts/".concat(t)).then((function(){return e(f(t))})).catch((function(t){return e(O(t))}))}}},7:function(t,e,n){"use strict";n.d(e,"a",(function(){return h})),n.d(e,"c",(function(){return g})),n.d(e,"b",(function(){return v}));var c=n(15),r=n.n(c),a=n(18),u=n(9),o=n.n(u),s=n(3);o.a.defaults.baseURL="https://connections-api.herokuapp.com";var i,l=function(t){o.a.defaults.headers.common.Authorization="Bearer ".concat(t)},d=function(){o.a.defaults.headers.common.Authorization=""},b=Object(s.c)("auth/register",function(){var t=Object(a.a)(r.a.mark((function t(e){var n,c;return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,o.a.post("/users/signup",e);case 3:return n=t.sent,c=n.data,l(c.token),t.abrupt("return",c);case 9:t.prev=9,t.t0=t.catch(0),console.log(t.t0.message);case 12:case"end":return t.stop()}}),t,null,[[0,9]])})));return function(e){return t.apply(this,arguments)}}()),j=Object(s.c)("auth/login",function(){var t=Object(a.a)(r.a.mark((function t(e){var n,c;return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,o.a.post("/users/login",e);case 3:return n=t.sent,c=n.data,l(c.token),t.abrupt("return",c);case 9:t.prev=9,t.t0=t.catch(0),console.log(t.t0.message);case 12:case"end":return t.stop()}}),t,null,[[0,9]])})));return function(e){return t.apply(this,arguments)}}()),f=Object(s.c)("auth/logOut",Object(a.a)(r.a.mark((function t(){return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,o.a.post("/users/logout");case 3:d(),t.next=9;break;case 6:t.prev=6,t.t0=t.catch(0),console.log(t.t0.message);case 9:case"end":return t.stop()}}),t,null,[[0,6]])})))),O=Object(s.c)("auth/refresh",function(){var t=Object(a.a)(r.a.mark((function t(e,n){var c,a,u;return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(null!==(c=n.getState().auth.token)){t.next=3;break}return t.abrupt("return",n.rejectWithValue());case 3:return l(c),t.prev=5,t.next=8,o.a.get("/users/current");case 8:return a=t.sent,u=a.data,t.abrupt("return",u);case 13:t.prev=13,t.t0=t.catch(5),console.log(t.t0.message);case 16:case"end":return t.stop()}}),t,null,[[5,13]])})));return function(e,n){return t.apply(this,arguments)}}()),h={register:b,login:j,logOut:f,getCurrentUser:O},g={getIsLoggedIn:function(t){return t.auth.isLoggedIn},getUserName:function(t){return t.auth.user.name},getIsFetchingCurrent:function(t){return t.auth.isFetchingCurrentUser}},p=n(4),v=Object(s.e)({name:"auth",initialState:{user:{email:null,name:null},token:null,isLoggedIn:!1,isFetchingCurrentUser:!1},extraReducers:(i={},Object(p.a)(i,h.register.fulfilled,(function(t,e){t.user=e.payload.user,t.token=e.payload.token,t.isLoggedIn=!0})),Object(p.a)(i,h.login.fulfilled,(function(t,e){console.log("\ud83d\ude80 ~ file: auth-slice.js ~ line 21 ~ action",e),t.user=e.payload.user,t.token=e.payload.token,t.isLoggedIn=!0})),Object(p.a)(i,h.logOut.fulfilled,(function(t){t.user={email:null,name:null},t.token=null,t.isLoggedIn=!1})),Object(p.a)(i,h.getCurrentUser.pending,(function(t){t.isFetchingCurrentUser=!0})),Object(p.a)(i,h.getCurrentUser.fulfilled,(function(t,e){t.user=e.payload,t.isLoggedIn=!0,t.isFetchingCurrentUser=!1})),Object(p.a)(i,h.getCurrentUser.rejected,(function(t){t.isFetchingCurrentUser=!1})),i)}).reducer},82:function(t,e,n){},83:function(t,e,n){},84:function(t,e,n){},85:function(t,e,n){},86:function(t,e,n){},87:function(t,e,n){"use strict";n.r(e);var c=n(0),r=n.n(c),a=n(23),u=n.n(a),o=n(16),s=n(6),i=n(43),l=n(25),d=n(3),b=n(17),j=n(44),f=n.n(j),O=n(45),h=n.n(O),g=n(31),p=n(7),v=[].concat(Object(l.a)(Object(d.f)({serializableCheck:{ignoredActions:[b.a,b.f,b.b,b.c,b.d,b.e]}})),[f.a]),x={key:"auth",storage:h.a,whitelist:["token"]},m=Object(d.a)({reducer:{auth:Object(b.g)(x,p.b),contacts:g.c},middleware:v,devTools:!1}),k=Object(b.h)(m),C=n(5),y=n(20),I=n(26),w=n(1),L=["children","redirectTo"],U=function(t){var e=t.children,n=t.redirectTo,c=void 0===n?"/":n,r=Object(I.a)(t,L),a=Object(s.c)(p.c.getIsLoggedIn);return Object(w.jsx)(C.b,Object(y.a)(Object(y.a)({},r),{},{children:a?e:Object(w.jsx)(C.a,{to:c})}))},_=["children","restricted","redirectTo"],N=function(t){var e=t.children,n=t.restricted,c=void 0!==n&&n,r=t.redirectTo,a=void 0===r?"/":r,u=Object(I.a)(t,_),o=Object(s.c)(p.c.getIsLoggedIn)&&c;return Object(w.jsx)(C.b,Object(y.a)(Object(y.a)({},u),{},{children:o?Object(w.jsx)(C.a,{to:a}):e}))},S=(n(82),function(){var t=Object(s.c)(p.c.getIsLoggedIn);return Object(w.jsxs)("nav",{children:[Object(w.jsx)(o.b,{exact:!0,className:"Navigation__link",to:"/",activeStyle:{color:"red"},children:"Home"}),t&&Object(w.jsx)(o.b,{className:"Navigation__link",to:"/contacts",activeStyle:{color:"red"},children:"Phonebook"})]})}),F=(n(83),function(){return Object(w.jsxs)("div",{className:"AuthNav__container",children:[Object(w.jsx)(o.b,{className:"AuthNav__link",to:"/register",activeStyle:{color:"red"},children:"Sign up"}),Object(w.jsx)(o.b,{className:"AuthNav__link",to:"/login",activeStyle:{color:"red"},children:"Login"})]})}),R=(n(84),function(){var t=Object(s.b)(),e=Object(s.c)(p.c.getUserName);return Object(w.jsxs)("div",{className:"UserMenu__container",children:[Object(w.jsxs)("span",{className:"UserMenu__text",children:["Welcome, ",e]}),Object(w.jsx)("button",{className:"UserMenu__button",onClick:function(){return t(p.a.logOut())},children:"LogOut"})]})}),A=(n(85),function(){var t=Object(s.c)(p.c.getIsLoggedIn);return Object(w.jsxs)(w.Fragment,{children:[Object(w.jsxs)("header",{className:"AppBar__header",children:[Object(w.jsx)(S,{}),t?Object(w.jsx)(R,{}):Object(w.jsx)(F,{})]}),Object(w.jsx)("hr",{})]})}),E=Object(c.lazy)((function(){return n.e(6).then(n.bind(null,96))})),z=Object(c.lazy)((function(){return n.e(5).then(n.bind(null,97))})),T=Object(c.lazy)((function(){return n.e(4).then(n.bind(null,98))})),q=Object(c.lazy)((function(){return n.e(3).then(n.bind(null,95))}));function M(){var t=Object(s.b)(),e=Object(s.c)(p.c.getIsFetchingCurrent);return Object(c.useEffect)((function(){t(p.a.getCurrentUser())}),[t]),!e&&Object(w.jsxs)("div",{className:"App",children:[Object(w.jsx)(A,{}),Object(w.jsx)(c.Suspense,{fallback:Object(w.jsx)("p",{children:"\u0417\u0430\u0433\u0440\u0443\u0437\u043a\u0430..."}),children:Object(w.jsxs)(C.d,{children:[Object(w.jsx)(N,{exact:!0,path:"/",children:Object(w.jsx)(E,{})}),Object(w.jsx)(N,{exact:!0,path:"/register",restricted:!0,children:Object(w.jsx)(z,{})}),Object(w.jsx)(N,{exact:!0,path:"/login",restricted:!0,redirectTo:"/contacts",children:Object(w.jsx)(T,{})}),Object(w.jsx)(U,{exact:!0,path:"/contacts",redirectTo:"/login",children:Object(w.jsx)(q,{})})]})})]})}n(86);u.a.render(Object(w.jsx)(r.a.StrictMode,{children:Object(w.jsx)(s.a,{store:m,children:Object(w.jsx)(i.a,{loading:null,persistor:k,children:Object(w.jsx)(o.a,{children:Object(w.jsx)(M,{})})})})}),document.getElementById("root"))}},[[87,1,2]]]);
//# sourceMappingURL=main.717d077e.chunk.js.map